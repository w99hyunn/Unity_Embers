using Mirror;
using UnityEngine;

namespace STARTING
{
    public class CameraMove : NetworkBehaviour
    {
        public Transform cameraTarget; // ???? ???? ???
        public Vector3 offset = new Vector3(0, 5, -10); // ?????? ??? ??????
        public float smoothSpeed = 0.125f; // ???? ???????? ?¥å???

        public Camera playerCamera;

        void Start()
        {
            // ???? ?¡À???????? ???
            if (!isLocalPlayer)
            {
                playerCamera.gameObject.SetActive(false);
                return; // ???? ?¡À???? ????? ???? ??????
            }

            if (playerCamera == null)
            {
                GameObject cameraObj = new GameObject("PlayerCamera");
                playerCamera = cameraObj.AddComponent<Camera>();
            }

            // ???? ?? ?¡À???? ??????? ????
            playerCamera.transform.SetParent(null); // ?????????? ???
            playerCamera.transform.position = cameraTarget.position + offset;
        }

        void Update()
        {
            // ???? ?¡À???? ???? ???????? ????
            if (!isLocalPlayer || playerCamera == null) return;

            // ??? ??? ???
            Vector3 desiredPosition = cameraTarget.position + offset;
            Vector3 smoothedPosition = Vector3.Lerp(playerCamera.transform.position, desiredPosition, smoothSpeed);

            // ???? ??? ???????
            playerCamera.transform.position = smoothedPosition;

            // ???? ??? ???? ???? ????
            playerCamera.transform.LookAt(cameraTarget);
        }
    }
}